extends ../../../views/layoutOnlyMain
include ../../activities/views/activities-mixins
include ../../wiki/views/wiki-mixins

block title
  | Dashboard
block content
  .row
    .col-sm-6
      +my_activities
    .col-sm-6
      .well: p Hier muss dann nochmal was sein
  +my_groups

mixin my_groups
  -var n = member.subscribedGroups.length
  -for(var i = 0; i < n; i += 3)
    .row
      -for(var j = i; j < Math.min(n, 3+i); j++)
        -var group = member.subscribedGroups[j]
          .col-sm-4
            .panel.panel-default
              .panel-heading(style="background-color: #{group.color};color: #FFFFFF")
                b #{group.longName}
              .panel-body
                +blogposts-inline(postsByGroup[group.id])
                if (changesByGroup[group.id].length > 0)
                  h4 Wiki Changes
                ul.list-unstyled
                  each changes in changesByGroup[group.id]
                    li
                      a(href="/wiki/#{changes.dirname()}/#{changes.pureName()}") #{changes.pureName()}
                      small: span.pull-right #{changes.date().lang(language).format('L')}

mixin my_activities
  .panel.panel-default
    .panel-heading
      b Kommende AktivitÃ¤ten
    ul.list-group
      each activity in activities
        -var angemeldet = (member && activity.allRegisteredMembers().indexOf(member.id()) > -1)
        li.list-group-item
          if (angemeldet)
            i.fa.fa-check.fa-fw.text-success.tooltipify(data-toggle="tooltip" title="Du bist angemeldet.")
          else
            i.fa.fa-question.fa-fw.tooltipify(data-toggle="tooltip" title="Du bist nicht angemeldet.")
          | &nbsp; #{activity.startMoment().lang(language).format('L')} &nbsp; 
          a(href='/activities/#{encodeURIComponent(activity.url())}') #{activity.title()}
          span.pull-right(style="color: #{activity.colorRGB};") #{activity.groupName()}
