extends ../../../views/layout
include ../../../../softwerkskammer/lib/members/views/memberlist-mixin
include ../../../../softwerkskammer/views/format-mixin
include ../../../../softwerkskammer/views/formComponents
include ../../../../softwerkskammer/views/dataTables-mixin

mixin individualRoom(resourceName)
  -var participants = activity.participantsOf(resourceName)
  -var resource = activity.socratesResourceNamed(resourceName)
  .panel
    table.table.table-condensed.table-hover.table-striped.unsortedtable
      thead
        tr
          th Donnerstag - Samstag
          th Samstag - Sonntag
          th Sonntag - Montag
      tbody
        for member in participants
          -var duration = resource.duration(member.id())
          -var name = member.displayName()
          tr
            td #{name}
            td #{duration > 2 ? name : ""}
            td #{duration > 4 ? name : ""}

mixin sharedRoom(resourceName)
  -var resource = activity.socratesResourceNamed(resourceName)
  .panel
    table.table.table-condensed.table-hover.table-striped.unsortedtable
      thead
        tr
          th(colspan="2") Donnerstag - Samstag
          th(colspan="2") Samstag - Sonntag
          th(colspan="2") Sonntag - Montag
        tr
          th 1. Teilnehmer
          th 2. Teilnehmer
          th 1. Teilnehmer
          th 2. Teilnehmer
          th 1. Teilnehmer
          th 2. Teilnehmer
      tbody
        for pair in rooms[resourceName].roomPairs
          -var name1 = pair.participant1.displayName()
          -var name2 = pair.participant2.displayName()
          -var duration1 = resource.duration(pair.participant1.id())
          -var duration2 = resource.duration(pair.participant2.id())
          tr
            td #{name1}
            td #{name2}
            td #{duration1 > 2 ? name1 : ""}
            td #{duration2 > 2 ? name2 : ""}
            td #{duration1 > 4 ? name1 : ""}
            td #{duration2 > 4 ? name2 : ""}
        for participant in rooms[resourceName].unpairedParticipants
          -var name = participant.displayName()
          -var duration = resource.duration(participant.id())
          tr
            td #{name}
            td
            td #{duration > 2 ? name : ""}
            td
            td #{duration > 4 ? name : ""}
            td


block scripts
  +dataTableImport
  +dataTable('.unsortedtable', '[]', '[]')
block title
  | Hotel-Informationen
block content
  .row
    .col-md-12
      .page-header
        h2 Hotel-Informationen
          a.btn.pull-right.btn-default(href='/registration') Zur√ºck
    ul.nav.nav-tabs
      li.active: a(href='#addresses', data-toggle='tab') Adressen
      li: a(href='#single', data-toggle='tab') Einzelzimmer
      li: a(href='#bed_in_double', data-toggle='tab') Doppelzimmer
      li: a(href='#bed_in_junior', data-toggle='tab') Junior-DZ Doppelbelegung
      li: a(href='#junior', data-toggle='tab') Junior-DZ Einzelbelegung
      li: a(href='#total', data-toggle='tab') Gesamt-Personenzahl
  .row
    .col-md-12
      .tab-content
        .tab-pane#addresses
          .panel
            table.table.table-condensed.table-hover.table-striped.unsortedtable
              thead
                tr
                  th Vorname
                  th Nachname
                  th Heimatadresse
                  th Rechnungsadresse
              tbody
                for line in addonLines
                  tr
                    td #{line.member.firstname()}
                    td #{line.member.lastname()}
                    td: +formatAsLines(line.addon.homeAddressLines())
                    td: +formatAsLines(line.addon.billingAddressLines())

        .tab-pane#single
          +individualRoom('single')

        .tab-pane#bed_in_double
          +sharedRoom('bed_in_double')

        .tab-pane#bed_in_junior
          +sharedRoom('bed_in_junior')

        .tab-pane#junior
          +individualRoom('junior')
